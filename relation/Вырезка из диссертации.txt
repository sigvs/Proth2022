Экспериментальные исследования расположения
локальных оптимумов в пространстве решений задачи оптимизации
свидетельствуют о том, что во многих задачах имеет место высокая
концентрация локальных оптимумов в непосредственной
близости от глобального оптимума~\cite{Reev}. Это наблюдение известно как
тезис о существовании <<большой долины>> для задач на минимум
или <<центрального массива>> для задач на максимум. Расстояние до глобального оптимума 
в нашем случае будем вычисляеть в метрике $l_1$.

\noindent Формулировку данного тезиса можно разбить на две части:
\begin{enumerate}[label={\arabic*)}]
\item Локальные оптимумы расположены относительно близко как друг к другу, так и к глобальному оптимуму.\newline
\item Значения целевой функции локальных оптимумов имеют тенденцию к ухудшению с увеличением расстояния до глобального оптимума.
\end{enumerate}

Этот тезис отчасти объясняет работоспособность генетических
алгоритмов. Если в популяции собираются локальные оптимумы и
очередное решение выбирается где-то между двумя произвольными
локальными оптимумами, то такой процесс имеет много шансов найти
глобальный оптимум. В связи с этим проверка и теоретическое
обоснование данной гипотезы представляет несомненный интерес.

С целью проверки данного тезиса в работе предложен метод
нахождения количества целочисленных точек в пересечении
шара заданного радиуса в метрике $l_1$ с параллелепипедом,
имеющим грани параллельные координатным плоскостям. Данный
метод был получен путем сведения задачи к комбинаторной
постановке, уже рассмотренной ранее для случая неотрицательных
целочисленных точек, с использованием
производящих функций~\cite{Sach}. В настоящей работе получено обобщение
указанного результата на нужные нам условия.

Зафиксировав набор неотрицательных целых
$ w_1, \ldots, w_n, w'_1, \ldots, w'_n$, рассмотрим полином вида

\begin{equation}
\label{P_NN_P_nn_1}
{P_{W'W}(s,t)=
	Q_{{w'_1}{w_1}}(s,t)\cdot \ldots \cdot
	Q_{{w'_n}{w_n}}(s,t)},
\end{equation}
\noindent где
${W=w_1+w_2+\ldots+w_n}$,
${W'=w'_1+w'_2+\ldots+w'_n}$ и
\begin{equation}
\label{P_nn_}
Q_{w'w}(s,t)=s^{w'}+s^{w'-1}+\ldots +s^2+s+1+t+t^2+\ldots + t^{w-1}+ t^{w}.
\end{equation}

Можно записать $P_{W'W}(s,t)$ в виде:
\begin{equation}
\label{P_NN_P_nn_2}
{P_{W'W}(s,t)=
	\sum\limits_{i=0}^{\max(W,W')}\sum\limits_{j=0}^i b_{ij} s^{i-j} t^j},
\end{equation}
\noindent где $b_{ij}$ - коэффициенты в разложении полинома $P_{W'W}(s,t)$.

Для произвольного $i \geq 0$ рассмотрим множество $\Omega_i$, в которое включены все точки,
находящиеся на расстоянии $i$ от $0$ в метрике $l_1$, таких что $j$-я координата каждой из
этих точек не может быть по значению больше $w_j$ и меньше $w'_j$.

\begin{equation}
\label{Omega_i}
{\Omega_i = \{x \in Z^n :	{ \| x \| }_{l_1} =i, -w'_j \leq x_j \leq w_j,\ j=1,2\ldots ,n\} }.
\end{equation}

Следующая лемма позволяет рассчитать мощность множества $\Omega_i$ через коэффициенты $b_{ij}$.

\begin{lemma}
	\begin{equation}
		\label{Th}
		\mid \Omega_i \mid\ = \sum\limits^i_{j=0} b_{ij}\  \mathtext{для любого} \ i\geq 0.
		\end{equation}
		\label{lemma_1}
\end{lemma}

\begin{proof} 
	Введем множество ${M_{ij}}$, как совокупность строк\\
	$({z_1},\cdots,\ {z_n},\ {y_1},\cdots,\ {y_n})$, таких что

\begin{enumerate}
	\item ${\sum^n_{k=1} z_k = i-j};$
	\item ${\sum^n_{k=1} y_k = j};$
	\item Если $y_k \neq 0$, то $z_k = 0\ \mathtext{для любого}\ k = 1,\ldots,n;$
	\item Если $z_k \neq 0$, то $y_k = 0\ \mathtext{для любого}\ k = 1,\ldots,n;$
	\item $z_k \leq n_k\ \mathtext{для любого}\ k = 1,\ldots,n ;$
	\item $y_k \leq n'_k\ \mathtext{для любого}\ k = 1,\ldots,n ;$
\end{enumerate}

\noindent Рассмотрим произвольный коэффициент $b_{ij}$ в разложении полинома
$P_{W^{'}W}(s,t)$. Так как все коэффициенты полинома (\ref{P_nn_}) равны 1, то
коэффициент ${b_{ij}}$ равен количеству членов вида
$ s^{z_1}\ldots s^{z_n}t^{y_1} \ldots t^{y_n} $ со
всевозможными наборами ${z_1} \cdots {z_n} {y_1} \cdots {y_n}$, удовлетворяющих  условиям
$1)\ldots6)$ в произведении (\ref{P_NN_P_nn_2}) до приведения подобных, а значит

\begin{equation}
\label{bkj}
b_{ij} =\mid M_{ij}\mid.
\end{equation}

\noindent Заметим, что $\mid \Omega_i \mid = \sum\limits_{j=0}^i \mid \Omega_{ij} \mid$, где

\begin{equation}
\label{Omega_ij}
{\Omega_{ij} = \{
	x \in \Omega_i :
	\sum\limits_{k:x_k < 0}\mid x_k \mid = j
	\} }.
\end{equation}
\noindent В множестве $\Omega_{ij}$ содержатся все точки, сумма координат по отрицательным
осям которых равно $j$.

Очевидно, что достаточно доказать только ${\mid \Omega_{ij} \mid =\mid M_{ij}\mid}$ для любого ${ i\geq 0,\ j=0,\ldots,i }$.

\noindent  Рассмотрим отображение $\ h:\Omega_{ij} \rightarrow  M_{ij} $,
сопоставляющее вектору $x$ строку $h(x)=(z_1(x) \ldots z_n(x), y_1(x) \ldots y_n(x))$
вида:

$$
z_k(x) =\left\{
\begin{array}{l}
{ 0,\ \mbox{если}\ x_k < 0} \\
{ x_k,\ \mbox{если}\ x_k \geq 0}
\end{array}\right.,
$$

$$
y_k(x) =\left\{
\begin{array}{l}
{ 0,\ \mbox{если}\ x_k \geq 0} \\
{ -x_k,\ \mbox{если}\ x_k < 0}
\end{array}\right.,
$$
\noindent где ${ k = 1,\ldots,n}$.
\noindent Кроме того, рассмотрим отображение $ g:M_{ij}\rightarrow  \Omega_{ij} $ вида:

$$
x_k(z_1 \ldots z_n, y_1 \ldots y_n) =\left\{
\begin{array}{l}
{ z_k,\ \mbox{если}\ z_k \geq 0} \\
{ -y_k,\ \mbox{если}\ y_k > 0}
\end{array}\right.,\ { k = 1,\ldots,n}.
$$

\noindent Легко видеть, что обе функции являются инъекциями по построению.
\end{proof}

Определим множество $\Omega$ следующим образом:

\begin{equation}
\label{Omega}
{\Omega = \{
	x \in Z^n :
	{ \| x \| }_{l_1} \leq r,
	-w^{\textit{'}}_j \leq x_j \leq w_j,\ j=1,2\ldots ,n
	\} },
\end{equation}


\begin{statement}
	\begin{equation}
	\label{Th}
	\mid \Omega \mid\ = \sum\limits^r_{i=0} \sum\limits^i_{j=0} b_{ij}.
	\end{equation}
\end{statement}

\begin{proof}
Так как множества $\Omega_i$ не пересекаются
по определению и $\Omega = \bigcup\limits_{i=0}^r \Omega_i$, то
по лемме~\ref{lemma_1} получаем
$\mid \Omega \mid\ = \sum\limits^r_{i=0}\mid\Omega_i\mid = \sum\limits^r_{i=0}\sum\limits^i_{j=0}
b_{ij}$.
\end{proof}

Поскольку задача перемножения полиномов $Q_{w_1^{'}w_1}(s,t),\ Q_{w_2^{'}w_2}(s,t)$
имеет трудоемкость равную $O(w_1^{'} w_1 w_2^{'} w_2)$, то
алгоритм вычисления количества целочисленных точек в пересечении
шара заданного радиуса в метрике $l_1$ с параллелепипедом,
имеющим грани параллельные координатным плоскостям имеет трудоемкость равную $O(n r^4)$.

Были проведены серии экспериментов на имеющихся задачах по
определению структуры локальных оптимумов. С помощью однократного
запуска алгоритма локального подъема АЛП решение $H$, элементы $h_i$ которого выбраны с
равномерным распределением между 1 и $d_i$, улучшалось до локального оптимума.
Данная процедура повторялась 300 раз для создания необходимого
размера выборки~\cite{Bose}. На основании полученных результатов было рассчитано
количество допустисых решений $\mid \Omega \mid$ в шарах, содержащих все найденные
локальные оптимумы. При этом за радиус шара бралось расстояние от
лучшего найденного локального оптимума до худшего, а за центр -
лучший найденный локальный оптимум.

В табл.~\ref{spher_as}-\ref{spher_bn} столбец $V1$ содержит мощность $\mid \Omega \mid$ для шаров, содержащих
локальные
оптимумы, столбец $V2$ содержит мощность всего пространства
решений для каждой задачи, а столбец $V1/V2$ -- их отношения.
Как видно из таблиц первая часть тезиса о существовании <<центрального горного массива>>, о том что
локальные оптимумы расположены относительно близко как друг к другу, так и к глобальному оптимуму,
в нашем случае не выполнена и в основном в используемых задачах
оптимумы сильно разбросаны по всему пространству решений.
\begin{table}[ht]
	\centering
	\begin{tabular}{|c|c|c|c|}
		\hline
		\hspace*{1.5mm}№\hspace*{1.5mm} &
		\hspace*{1.5cm}$V1$\hspace*{1.5cm}&
		\hspace*{1.5cm}$V2$\hspace*{1.5cm}&
		\hspace*{0.5cm}$V1/V2$\hspace*{0.5cm}\\
		\hline
		1 &  2,84E+05  &  5,74E+05 &   0,49\\
		2 &  8,88E+11  &  9,48E+11 &   0,94\\
		3 &  8,60E+01  &  4,85E+03 &   0,02\\
		4 &  2,34E+22  &  2,89E+22 &   0,81\\
		5 &  4,17E+07  &  9,75E+07 &   0,43\\
		6 &  1,00E+00  &  5,23E+08 &   0,00\\
		\hline
	\end{tabular}
	%\vspace{1em}
	\caption{Результаты многократного запуска локального поиска для серии as.1 - as.6}	\label{spher_as}
\end{table}
\begin{table}[ht]
	\centering
	\begin{tabular}{|c|c|c|c|}
		\hline
		\hspace*{1.5mm}№\hspace*{1.5mm} &
		\hspace*{1.5cm}$V1$\hspace*{1.5cm}&
		\hspace*{1.5cm}$V2$\hspace*{1.5cm}&
		\hspace*{0.5cm}$V1/V2$\hspace*{0.5cm}\\
		\hline
		9  & 7,97E+03  &  1,00E+04  &  0,80\\
		10 & 7,55E+03  &  1,46E+04  &  0,52\\
		\hline
	\end{tabular}
	%\vspace{1em}
	\caption{Результаты многократного запуска локального поиска для серии vp6.9 - vp6.10}	\label{spher_vp6}
\end{table}
\begin{table}[ht]
	\centering
	\begin{tabular}{|c|c|c|c|}
		\hline
		\hspace*{1.5mm}№\hspace*{1.5mm} &
		\hspace*{1.5cm}$V1$\hspace*{1.5cm}&
		\hspace*{1.5cm}$V2$\hspace*{1.5cm}&
		\hspace*{0.5cm}$V1/V2$\hspace*{0.5cm}\\
		\hline
		9  & 6,50E+03  &  1,00E+04  &  0,65\\
		10 & 9,95E+03  &  1,46E+04  &  0,68\\
		\hline
	\end{tabular}
	%\vspace{1em}
	\caption{Результаты многократного запуска локального поиска для серии vp7.9 - vp7.10}	\label{spher_vp7}
\end{table}

Также рассматривалась часть тезиса о тенденции к ухудшению значения целевой функции локальных оптимумов
с увеличением расстояния до глобального оптимума. Для этого у всех рассматриваемых задач определялась корреляция
$\rho(\varphi(\xi),r(\xi,\xi^*))$ значения целевой функции
локальных оптимумов $\varphi(\xi)$ и расстояния до глобального оптимума $r(\xi,\xi^*)$.
Как показали эксперименты на предложенных задачах имеется отрицательная корреляция $\rho$, причем все значения
корреляции значимо отличаются от 0 с уровнем доверия 95\% (таблицы~\ref{res_korr_as_vp}--\ref{res_korr_bn_vp}).

\begin{table}[h!]
	\vspace{1cm}
	\centering
	\begin{tabular}{|c|c|c|c|}
		\hline
		\hspace*{1.5mm}№\hspace*{1.5mm} &
		\hspace*{1.5cm}$V1$\hspace*{1.5cm}&
		\hspace*{1.5cm}$V2$\hspace*{1.5cm}&
		\hspace*{0.5cm}$V1/V2$\hspace*{0.5cm}\\
		\hline
		1 &  1,44E+05  &  1,94E+05  &  0,74\\
		2 &  9,96E+03  &  1,94E+05  &  0,05\\
		3 &  9,07E+04  &  1,94E+05  &  0,47\\
		4 &  2,06E+04  &  1,94E+05  &  0,11\\
		5 &  6,95E+04  &  1,94E+05  &  0,36\\
		6 &  6,94E+04  &  1,94E+05  &  0,36\\
		7 &  2,45E+04  &  1,94E+05  &  0,13\\
		8 &  3,42E+03  &  1,94E+05  &  0,02\\
		9 &  6,28E+04  &  1,94E+05  &  0,32\\
		10&  1,00E+00  &  1,94E+05  &  0,00\\
		\hline
	\end{tabular}
	\vspace{1em}
	\caption{Результаты многократного запуска локального поиска для серии bn5.1 - bn5.10}	\label{spher_bn}
\end{table}
\begin{table}[h!]
	\centering
	\begin{tabular}{|c|c|}
		\hline
		%\hspace*{2mm} № \hspace*{2mm} & \hspace*{5.1cm} $\rho(r(\xi, \xi*),\varphi(\xi))$\hspace*{5.1cm}\\
		\hspace*{2mm} № \hspace*{2mm} & \hspace*{1cm} $\rho(r(\xi, \xi*),\varphi(\xi))$\hspace*{1cm}\\
		\hline
		\multicolumn{2}{|c|}{Серия as.1 - as.5}\\
		\hline
		1  & -0,87078206\\
		2  & -0,437208613\\
		7  & -0,547348483\\
		8  & -0,943725905\\
		\hline
		\multicolumn{2}{|c|}{Серия vp6.9 - bn6.10}\\
		\hline
		9  & -0,833583818\\
		10 & -0,778237651\\
		\hline	
	\end{tabular}
	\vspace{1em}
	\caption{Результаты вычислений корреляций для серий $as$ и $vp6$}	\label{res_korr_as_vp}
\end{table}

\begin{table}[h!]
	\centering
	\begin{tabular}{|c|c|}
		\hline
		%\hspace*{2mm} № \hspace*{2mm} & \hspace*{5.1cm} $\rho(r(\xi, \xi*),\varphi(\xi))$\hspace*{5.1cm}\\
		\hspace*{2mm} № \hspace*{2mm} & \hspace*{1cm} $\rho(r(\xi, \xi*),\varphi(\xi))$\hspace*{1cm}\\
		\hline
		\multicolumn{2}{|c|}{Серия bn5.1 - bn5.9}\\
		\hline
		1  & -0,706451573\\
		2  & -0,872602935\\
		3  & -0,914939714\\
		4  & -0,999969666\\
		5  & -0,972555479\\
		6  & -0,729655068\\
		7  & -0,973827419\\
		8  & -0,846807033\\
		9  & -0,884916669\\
		\hline
		\multicolumn{2}{|c|}{Серия vp7.9 - bn7.10}\\
		\hline
		9  & -0,907792301\\
		10 & -0,889724863\\		
		\hline		
	\end{tabular}
	\vspace{1em}
	\caption{Результаты вычислений корреляций для серий $bn$ и $vp7$}	\label{res_korr_bn_vp}
\end{table}

Интересным фактом является то,
что в задачах as.6, bn5.1 все множество локальных оптимумов распадается
на кластеры, для каждого из которых справедлива часть тезиса о тенденции к
ухудшению значения целевой функции локальных оптимумов
с увеличением расстояния до глобального оптимума.

На рис.~\ref{klaster_as4} и ~\ref{klaster_bn5_1} приведены диаграммы локальных оптимумов задач
as.6, bn5.1, где по оси ординат отображено значение целевой функции локального оптимума $\varphi(H)$, а по оси абсцисс -- 
расстояние в метрике $l_1$ до выбранного решения.

Эффект кластеризации особенно хорошо проявляется на задачах с параллельными участками линии.
Обоснованием данного эффекта может служить то, что в линиях с параллельной структурой существует несколько различных путей
от начального бункера к конечному бункеру. Таким образом, если создать две линии одинаковые по структуре графа,
такие что у одной линии сравнительно большие по размеру бункеры будут располагаться по одному пути, а у другой --
по другому, то можно добиться двух близких по значению целевой функции решений, но расположенных на <<достаточно>>
большом расстоянии друг от друга.
\begin{figure}[h!]
	\begin{center}
		\includegraphics[scale=0.38]{klaster_as4.png}\\
		\caption{Структура локальных оптимумов задачи as6.} \label{klaster_as4}
	\end{center}
\end{figure} 
\begin{figure}[h!]
	\vspace{-1cm}
	\begin{center}
		\includegraphics[scale=0.38]{klaster_bn5_1.png}\\
		\caption{Структура локальных оптимумов задачи bn5.1.} \label{klaster_bn5_1}
	\end{center}
	\vspace{-1cm}
\end{figure} 

Ещё одной из причин эффекта кластеризации является свойство
симметрии линии. Данное свойство установлено в~\cite{LP} для последовательной линии, 
состоящей из двух ЕО и бункера
между ними. Если поменять местами параметры первой и второй ЕО так,
что входной участок линии станет выходным, а выходной -- входным, то
производительность линии не изменится.

Рассмотрим пример последовательной линии t.1 из
%{\frac{1}{T^{\rm O}_j} = 2U_j}, {\frac{1}{T^{\rm B}_j}= 4U_j}, {U_j = U_{j+1}}
трех ЕО и двух бункеров между ними со следующими параметрами: ${T^{\rm O}_i=T^{\rm B}_i=1}$, $i = 1,\ldots,3$;
 ${U_1=1}$, ${U_2=0.5}$ , ${U_3=1}$;
 ${d_j=4}$, ${c_j=0}$, $j = 1,\ldots,2$;
 $T_{\mathtext{ам}}=7000$;
 $J(H)=50\cdot(h_1+h_2)$;
 если $V(H) < 2570$, то $R(V(H))=0.9\cdot V(H)$, в противном случае $R(V(H))=2570$.
 \begin{figure}[h!]
	\centering
	\includegraphics[scale=1.1]{test}
  \caption{Значения целевой функции на множестве $D$ для задачи t.1\label{t_1}}
  \end{figure}

Множество глобальных оптимумов (см. рис.~\ref{t_1}) данного примера распадается на два кластера. В
первый кластер входят решения $H^1=(1,2)$ и $H^2=(1,3)$, а во
второй -- решения $H^3=(2,1)$ и $H^4=(3,1)$. Кластеризация оптимумов в
рассмотренном примере является следствием симметрии и особенностями
алгоритма агрегирования из~\cite{Dol}, используемого при вычислении средней
производительности линии.

В общем случае для линий с количеством бункеров $n\geq 3$ эффект
симметрии может наблюдаться на нескольких внутренних участках
линиии. Это приводит к тому, что при данном алгоритме агрегирования
множество локальных оптимумов распадается на несколько кластеров.